<!doctype html>
<html lang='en-us'><head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WBN59M8Y5S"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-WBN59M8Y5S');
</script>


<script type="text/javascript">
  (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
  m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
  (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

  ym(53961409, "init", {
       clickmap:true,
       trackLinks:true,
       accurateTrackBounce:true,
       webvisor:true
  });
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/53961409" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<meta charset="utf-8">

  
  <link rel="stylesheet" href="/style.min.a3a4a7a8e8602aaa85b7cb3d655edde028ac80d73f2a97389e2cbcf995dd672d.css" integrity="sha256-o6SnqOhgKqqFt8s9ZV7d4CisgNc/Kpc4niy8&#43;ZXdZy0=">
  <link rel="stylesheet" href="/syntax.css" id="syntax-theme">

  <link rel="stylesheet" type="text/css" href="https://tikzjax.com/v1/fonts.css">
  <script src="https://tikzjax.com/v1/tikzjax.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js"></script>
  <script src="/scripts/lunr.stemmer.support.min.js"></script>
  <script src="/scripts/lunr.ru.min.js"></script>
  <script src="/scripts/lunr.multi.min.js"></script>

  
  <link rel="stylesheet" id="theme">

  <script>
    function toggleSidebar() {
      console.log("Toggling sidebar visibility")
      var sidebar = document.getElementById('sidebar')
      var wrapper = document.getElementById('wrapper')
      if (sidebar.classList.contains('sidebar-toggled') || window.getComputedStyle(sidebar).display == 'block') { 
        sidebar.classList.toggle('sidebar-hidden')
        wrapper.classList.toggle('sidebar-hidden')
      }
      sidebar.classList.add('sidebar-toggled')
      wrapper.classList.add('sidebar-toggled')
    }

    function switchTheme(theme) {
      console.log("Changing theme:", theme)
      document.getElementById('theme').href = (theme == 'dark' ? "\/dark.min.b3ae1169831434b11b48de5b3e3210547eea6b7884c295ab0030cb973ea0dc49.css" : "")
      document.getElementById('syntax-theme').href = (theme == 'dark' ? '/syntax-dark.css' : '/syntax.css')
      localStorage.setItem('theme', theme)
    }

    async function toggleSearch() {
      console.log("Toggling search")
      
      var searchDiv = document.getElementById('search')
      if (window.getComputedStyle(searchDiv).display == 'none') {
        searchDiv.style.display = 'block'
        window.scrollTo({ top: 0 });
        document.getElementById('search-bar').focus()
      } else {
        searchDiv.style.display = 'none'  
      }

      if (!index) {
        console.log("Fetching index")
        const response = await fetch('/searchindex.json')
        const pages = await response.json()
        index = lunr(function() {
          this.use(lunr.multiLanguage('en', 'ru'))
          this.field('title', {
            boost: 5
          })
          this.field('content', {
            boost: 1
          })
          pages.forEach(function(doc) {
            this.add(doc)
            articles.push(doc)
          }, this)
        })
        console.log("Ready to search")
      }
    }

    var articles = []
    var index = undefined

    function search() {
      var query = document.getElementById('search-bar').value
      var resultsDiv = document.getElementById('search-results')
      var countDiv = document.getElementById('search-count')
      
      if (query == '') {
        resultsDiv.innerHTML = ''
        countDiv.innerHTML = ''
        return
      }
      
      var results = index.search(query)

      countDiv.innerHTML = 'Found <b>' + results.length + '</b> pages'

      let resultList = ''

      for (const n in results) {
        const item = articles[results[n].ref]
        resultList += '<li><a href="' + item.path + '">' + item.title + '</a> <p>'
        const text = item.content

        const contextLimit = 80

        if (text.includes(query)) {
          const start = text.indexOf(query)
          if (start > contextLimit)
            resultList += '…'
          resultList += text.substring(start - contextLimit, start)
                      + '<b>' + query + '</b>' + text.substring(start + query.length, start + query.length + contextLimit)

        } else {
          resultList += text.substring(0, contextLimit * 2)
        }
        resultList += '…</p></li>'
      }

      resultsDiv.innerHTML = resultList
    }

    if (localStorage.getItem('theme') == 'dark') {
      switchTheme('dark')
    }

    window.addEventListener('load', function() {
      var el = document.getElementById("active-element")
      
      if (el) {
        el.scrollIntoView({block: "center"})
      }
      

    })

    window.addEventListener('scroll', function() {
      var menu = document.getElementById('menu')
      if (window.scrollY < 120) {
        
        menu.classList.remove('scrolled')
      } else {
        
        menu.classList.add('scrolled')
      }
    })

    window.addEventListener('keydown', function(e) {
      if (e.altKey) { return }
      if (document.activeElement.tagName == 'INPUT') { return }
      if (e.key == 'ArrowLeft') {
        document.getElementById('prev-article').click()
      } else if (e.key == 'ArrowRight') {
        document.getElementById('next-article').click()
      }
    })
  </script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"
  onload="renderMathInElement(document.body, {
    delimiters: [
      {left: '$$', right: '$$', display: true},
      {left: '$', right: '$', display: false}
    ]
  })"></script>

  
  <title>大组合数模小质数幂 - Reliauk</title>
</head>
<body><nav id='sidebar' >
  
  
  <div class='title'>
    <a href='/'>Reliauk</a>
    
      
        
        <span class='slash'>/</span>
        <a href='/misc/' class='divisionAbbr'
            >
          Misc
        </a>
      
    
      
    
  </div>
  <ul>
    
      
        
        <li class=' '><a href='/misc/binom-mod-pe/'
          id='active-element'
          >大组合数模小质数幂</a></li>
        
      
        
        <li class=' '><a href='/misc/circ-cover/'
          
          >一类三分套三分在圆覆盖问题中的应用</a></li>
        
      
        
        <li class=' '><a href='/misc/avoid-pattern-rdl/'
          
          >避免 Pattern 的 RDL 计数</a></li>
        
      
    
  </ul>
</nav>
<div id='wrapper' ><menu id='menu'>
  
  
  <div class='left'>
    <a>
      <img src='/icons/bars-solid.svg'
           onclick='toggleSidebar()'
           title='open table of contents'>
    </a>
    <a>
      <img src='/icons/adjust-solid.svg'
           style='position: relative; top: -1px'
           onclick='switchTheme(localStorage.getItem("theme") == "dark" ? "light" : "dark")'
           title='dark theme'>
    </a>
    <a>
      <img src='/icons/search-solid.svg'
           onclick='toggleSearch()'
           title='search'>
    </a>
  </div>
  <div class='title'>大组合数模小质数幂</div>
  <div class='right'>
    <a onClick='window.print()'>
      <img src='/icons/print-solid.svg' title='print'>
    </a>
  </div>
</menu>
<main>
        <div id="search">
    <input id="search-bar" type="search" placeholder='Search this book…' oninput="search()">
    <div id="search-count"></div>
    <div id="search-results">
    </div>
</div>
<header>
  
  <h1>大组合数模小质数幂</h1>
  
    <div class='info'></div>
  
</header>
<article>



  
    
    
      
        <span class='anchor' id="背景"></span>
<h2><a class="anchor-link" href="https://faqak.github.io/misc/binom-mod-pe/#%e8%83%8c%e6%99%af">#</a>背景</h2><p>我们想求解的是这样一类问题：固定模数 $p^e$，多次查询 $\binom nm \bmod p^e$，默认一般情况下 $p &gt; e$。</p>
<p>当 $n$ 和 $m$ 比较小的时候，预处理阶乘数组可以很好地解决问题。因此我们主要关心的是当 $n$ 和 $m$ 很大（比如 $10^{18}$ 量级）时该问题是否有很好的解法。下面将介绍该问题的一种方向。</p>
<p>我们很容易 $\mathcal O(\log n)$ 计算出 $n!$ 中含有的 $p$ 因子数量 $(n!)_p = \sum _{k\geq 1} \lfloor\frac{n}{p^k}\rfloor$。那么有</p>

      
    
  

  
    $$
    
\dbinom nm = \dfrac{n!}{m!(n - m)!}=\dfrac{\dfrac{n!}{p^{(n!)_p}}}{\dfrac{m!}{p^{(m!)_p}}\dfrac{(n - m)!}{p^{((n - m)!)_p}}}p^{(n!)_p - (m!)_p - ((n - m)!)_p}

    $$
  

  
    
    
      
        问题还是落在了计算 $\dfrac{n!}{p^{(n!)_ p}}$ 上。如果我们能够计算 $\displaystyle F(n) = \prod_{i=1, i\perp p}^n i$，那么仍然可以得到：
      
    
  

  
    $$
    
\dfrac{n!}{p^{(n!)_p}} = \prod_{k\geq 0}F(\lfloor \dfrac{n}{p^k}\rfloor)

    $$
  

  
    
    
      
        <p>因此这个方向的核心在于计算 $F$，如果我们能够以 $\mathcal O(t)$ 单次的时间复杂度回答 $F$，那么问题就可以以 $\mathcal O(t \log n)$ 的时间复杂度被解决。</p>
<p>下面将介绍几种常见的计算 $F$ 的方法。</p>
<span class='anchor' id="exlucas"></span>
<h2><a class="anchor-link" href="https://faqak.github.io/misc/binom-mod-pe/#exlucas">#</a>ExLucas</h2>
      
    
  

  
    $$
    
\begin{aligned}
F(n) &= \prod_{i=1, i\perp p}^n i\\
&\equiv \left(\prod_{i=1, i\perp p}^{p^e} i\right)^{(n / p^e)}\prod_{i=1,i\perp p}^{n \bmod p^e}i
\end{aligned}

    $$
  

  
    
    
      
        <p>枚举就好了！时间复杂度 $\mathcal O(p^e)$。</p>
<span class='anchor' id="少项式平移"></span>
<h2><a class="anchor-link" href="https://faqak.github.io/misc/binom-mod-pe/#%e5%b0%91%e9%a1%b9%e5%bc%8f%e5%b9%b3%e7%a7%bb">#</a>少项式平移</h2><p>相关题目：「2018 集训队互测 Day 1」完美的集合，那题是模 $5^{23}$。</p>
<p>考虑设计多项式 $\displaystyle G_n(x) = \prod_{i=1, i\perp p}^n(x + i)$，我们要求的 $F(n)$ 即为 $G_n(0)$。</p>
<p>考虑从 $G_p(x)$ 开始，倍增得到 $G_{\lfloor \frac{n}{p} \rfloor p}(x)$，再暴力乘 $n \bmod p$ 个 $(x + i)$。</p>
<p>若要倍增，则需要解决 $G_{ap} \to G_{2ap}$ 和 $G_{ap} \to G_{(a + 1)p}$ 的问题。</p>
<ul>
<li>$G_{2ap}(x) = G_{ap}(x)\times G_{ap}(x + ap)$，后一部分可以二项式定理暴力展开，原因下面会提到；</li>
<li>$G_{(a + 1)p}(x) = G_{ap}(x) \times G_p(x + ap)$，同上。</li>
</ul>
<p>注意到，$x$ 始终是 $p$ 的倍数，这意味着在 $\bmod \ p^e$ 意义下，我们只需要保留前 $e$ 项进行运算，这也保证了我们可以暴力展开、暴力乘法等。</p>
<p>每次 $ap \to 2ap$ 或 $ap \to (a + 1)p$ 所需的时间是 $\mathcal O(e^2)$，故回答 $F$ 的时间复杂度为 $\mathcal O(e^2\log n)$。</p>
<p>注意我们要预处理 $G_0 \sim G_p$ 的系数，不仅为了求一开始的 $G_p$，还为了最后的暴力乘不用真的乘 $n \bmod p = \mathcal O(p)$ 次，而是直接乘 $G_{n \bmod p}(x + \lfloor \frac np\rfloor p)$。预处理的时间复杂度是 $\mathcal O(pe)$ 的。</p>
<span class='anchor' id="min_25-binom"></span>
<h2><a class="anchor-link" href="https://faqak.github.io/misc/binom-mod-pe/#min_25-binom">#</a>min_25 binom</h2><p>考虑让 $n$ 对 $p$ 做带余除法，假设得到 $n = up + v$。我们有：</p>

      
    
  

  
    $$
    
\begin{aligned}
F(n) &= \left (\prod_{i=0}^{u-1}\prod_{j=1}^{p - 1}(ip + j)\right)\prod_{j=1}^v(up + j)\\
&= \left(\prod_{i=0}^{u - 1}\sum_{k=0}^{p-1}(ip)^k\begin{bmatrix}p\\k + 1\end{bmatrix}\right)\left(\sum_{k=0}^v(up)^k\begin{bmatrix}v + 1\\k + 1\end{bmatrix}\right)
\end{aligned}

    $$
  

  
    
    
      
        上面是一个上升幂转普通幂。注意到 $(ip)^k$ 和 $(up)^k$ 当 $k \geq e$ 时模意义下直接变成 $0$ 了，故我们可以进一步优化：
      
    
  

  
    $$
    
\begin{aligned}
F(n) &\equiv \left(\prod_{i=0}^{u - 1}\sum_{k=0}^{e-1}(ip)^k\begin{bmatrix}p\\k + 1\end{bmatrix}\right)\left(\sum_{k=0}^{e - 1}(up)^k\begin{bmatrix}v + 1\\k + 1\end{bmatrix}\right)\\
&= \begin{bmatrix}p\\1\end{bmatrix}^u\left(\prod_{i=0}^{u - 1}\sum_{k=0}^{e - 1}(ip)^k\dfrac{\begin{bmatrix}p\\k + 1\end{bmatrix}}{\begin{bmatrix}p\\1\end{bmatrix}}\right)\left(\sum_{k=0}^{e - 1}(up)^k\begin{bmatrix}v + 1\\k + 1\end{bmatrix}\right)\\
&= \begin{bmatrix}p\\1\end{bmatrix}^uf_e(p, u)\left(\sum_{k=0}^{e - 1}(up)^k\begin{bmatrix}v + 1\\k + 1\end{bmatrix}\right)
\end{aligned}

    $$
  

  
    
    
      
        <p>让我们用稍微跳脱的眼光看待 $\begin{bmatrix} p \\ 1 \end{bmatrix}^u$，我们把这 $\log$ 次求解 $F$ 中的这玩意提出来放一起。实际上就是在最终回答 $\dfrac{n!}{p^{(n!)_ p}}$ 的时候用 $\mathcal O(\log n)$ 快速幂算出 $\begin{bmatrix}p\\1\end{bmatrix}^{(n!)_p}$ 给答案乘上，这显然不会成为瓶颈。</p>
<p>再说后面的 $\displaystyle \left(\sum_ {k=0}^{e - 1}(up)^k\begin{bmatrix}v + 1\\k + 1\end{bmatrix}\right)$，这个可以先 $\mathcal O(pe)$ 预处理出所有 $i \in [0, p], j \in [0, e]$ 的 $\begin{bmatrix}i\\j\end{bmatrix}$，然后每次问 $F$ 的时候就只需要 $\mathcal O(e)$ 累乘了。</p>
<p>因此，我们最大的问题在于计算 $f_e(p, u)$，而且看起来似乎没有任何头绪。但出人意料的是，$f_e(p, u)$ 的性质很好！</p>
<p>事实上，$f_e(p, u)$ 是关于 $u$ 的 $(2e - 2)$ 次多项式！</p>
<blockquote>
<p><strong>证明.</strong></p>
<p>首先明确方向：为了确定这样的多元多项式关于积式枚举范围的次数，我们最好取个 $\ln$，求解关于和式枚举范围的次数（一般不是很困难），然后再 $\exp$ 回去。</p>
<p>懒得写那个系数了，把它简记为 $a_k$，那么 $f_e(p, u)$ 形如</p>
</blockquote>

      
    
  

  
    $$
    
 f_e(p, u) = \prod_{i=0}^{u - 1}\sum_{k=0}^{e - 1}a_k(ip)^k
 
    $$
  

  
    
    
      
        <blockquote>
<p>注意到我们在上面推式子时已经通过除以 $\begin{bmatrix}p\\1\end{bmatrix}$ 保证了 $a_0 = 1$，那么就可以两边取 $\ln$ 了：</p>
</blockquote>
      
    
  

  
    $$
    
\begin{aligned}
\ln f_e(p, u) &= \sum_{i=0}^u\ln(1 + \sum_{k=1}^{e - 1}a_k(ip)^k)\\
&= \sum_{i=0}^u\sum_{k \geq 1}b_k(ip)^k\\
&= \sum_{k \geq 1}b_k p^k \sum_{i=0}^u i^k\\
&= \sum_{k \geq 1}b_k s_k(u) p^k
\end{aligned}

    $$
  

  
    
    
      
        <blockquote>
<p>那么我们可以 $\exp$ 回去了。</p>
</blockquote>
      
    
  

  
    $$
    
\begin{aligned}
f_e(p, u) &= \exp(\sum_{k \geq 1}b_ks_k(u)p^k)\\
&= \sum_{i\geq 0} \dfrac{(\sum_{k\geq1}b_ks_k(u)p^k)^i}{i!}\\
\end{aligned}

    $$
  

  
    
    
      
        <blockquote>
<p>我们现在要分析 $f_e(p, u)$ 中 $p^k$ 项所对 $u$ 的最高次项系数。假设其由 $\ln f_e(p, u)$ 中的 $p^{i_1}, p^{i_2}, \cdots, p^{i_j}$ 这 $j$ 项相乘贡献，那么含有 $u$ 的部分其实是 $\prod_{q=1}^j s_{i_q}(u)$。经典结论是 $s_x(u)$ 是关于 $u$ 的 $x + 1$ 次多项式，因此此时 $u$ 的次数是 $\sum (i_q + 1) = \sum i_q + j = k + j$，所以 $j$ 越大，贡献中的 $u$ 的次数越多。$j$ 最大时显然是 $j = k$ 且 $i_1 = i_2 = \cdots = i_j = 1$ 时，此时 $u$ 的次数为 $j + k = 2k$。因此，我们知道：$p^k$ 所对 $u$ 的最高次项系数为 $2k$。</p>
<p>不要忘了题目对 $p^e$ 取模的条件。因此我们仍然可以把 $k \geq e$ 的项略去，此时整个多项式即为关于 $u$ 的 $(2e - 2)$ 次多项式。</p>
<p>$\mathbf{\square.}$</p>
</blockquote>
<p>因此，根据已经预处理好的第一类斯特林数，可以 $\mathcal O(e^2)$ 预处理出 $f_e(p, 0), f_e(p, 1), \cdots, f_e(p, 2e-2)$。然后即可在回答询问时 $\mathcal O(e)$ 拉插出 $f_e(p, u)$。</p>
<p>综上，使用这种方法求解 $F$，可以做到 $\mathcal O(pe)$ 预处理，$\mathcal O(e)$ 回答 $F$。</p>
<span class='anchor' id="ex-少项式平移"></span>
<h2><a class="anchor-link" href="https://faqak.github.io/misc/binom-mod-pe/#ex-%e5%b0%91%e9%a1%b9%e5%bc%8f%e5%b9%b3%e7%a7%bb">#</a>ex 少项式平移</h2><p>考虑平衡『少项式平移』中预处理和询问的复杂度。</p>
<p>具体来说，我们可以直接对 $0 \leq i \leq 7, 1 \leq j &lt; 256$ 预处理 $G_{256^i \cdot j \cdot p}$，每次回答拿出要用的多项式以后，就不需要用二项式定理平移它们并乘起来了。可以分别算出需要代入的 $x$ 并求点值，最后乘起来。回答 $F$ 的时间复杂度优化至 $\mathcal O(e \log_{256} n)$。</p>
<p>在 OI 常见的数据范围中（如 $n, k \leq 10^{18}$），这个 $\log_{256} n$ 实际上是快于 min_25 binom 做法中隐含的常数的。</p>
<p>作者用 <a href="https://vjudge.net/problem/HackerRank-euler242">Project Euler #242: Odd Triplets</a> 测试了『min_25 binom』和『ex 少项式平移』的效率，在本地的最大运行速度分别为 1.8s 和 0.9s。</p>
<span class='anchor' id="代码"></span>
<h2><a class="anchor-link" href="https://faqak.github.io/misc/binom-mod-pe/#%e4%bb%a3%e7%a0%81">#</a>代码</h2><p>这是一份可以通过 <a href="https://vjudge.net/problem/HackerRank-euler242">Project Euler #242: Odd Triplets</a> 的代码。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/extc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define ALL(v) begin(v), end(v)
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">i64</span> <span class="o">=</span> <span class="kt">int64_t</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">i128</span> <span class="o">=</span> <span class="n">__int128</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">Exgcd</span><span class="p">(</span><span class="n">i64</span> <span class="n">a</span><span class="p">,</span> <span class="n">i64</span> <span class="n">b</span><span class="p">,</span> <span class="n">i128</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="n">i128</span> <span class="o">&amp;</span><span class="n">y</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">b</span><span class="p">)</span> <span class="k">return</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="kt">void</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Exgcd</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">%</span> <span class="n">b</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">y</span> <span class="o">-=</span> <span class="p">(</span><span class="n">a</span> <span class="o">/</span> <span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">auto</span> <span class="nf">Inv</span><span class="p">(</span><span class="n">i64</span> <span class="n">x</span><span class="p">,</span> <span class="n">i64</span> <span class="n">p</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">i64</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">i128</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">Exgcd</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="p">(</span><span class="n">a</span> <span class="o">%</span> <span class="n">p</span> <span class="o">+</span> <span class="n">p</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="n">binomial</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">kMaxE</span> <span class="o">=</span> <span class="mi">63</span><span class="p">,</span> <span class="n">kMaxP</span> <span class="o">=</span> <span class="mf">1E5</span> <span class="o">+</span> <span class="mi">5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">i64</span> <span class="n">pe</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">Add</span><span class="p">(</span><span class="n">i64</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="n">i64</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">((</span><span class="n">x</span> <span class="o">+=</span> <span class="n">y</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">pe</span><span class="p">)</span> <span class="n">x</span> <span class="o">-=</span> <span class="n">pe</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">auto</span> <span class="nf">Sum</span><span class="p">(</span><span class="n">i64</span> <span class="n">x</span><span class="p">,</span> <span class="n">i64</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">Add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">x</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">__gnu_pbds</span><span class="o">::</span><span class="n">cc_hash_table</span><span class="o">&lt;</span><span class="n">i64</span><span class="p">,</span> <span class="n">i64</span><span class="o">&gt;</span> <span class="n">memo</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="n">i64</span><span class="p">,</span> <span class="n">kMaxE</span><span class="o">&gt;</span> <span class="n">power</span><span class="p">{</span><span class="mi">1</span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="n">i64</span><span class="p">,</span> <span class="n">kMaxE</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">kMaxE</span><span class="o">&gt;</span> <span class="n">binom</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="n">i64</span><span class="p">,</span> <span class="n">kMaxE</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">kMaxP</span><span class="o">&gt;</span> <span class="n">g</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="n">i64</span><span class="p">,</span> <span class="n">kMaxE</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">kMaxE</span><span class="o">&gt;</span> <span class="n">gp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="n">i64</span><span class="p">,</span> <span class="n">kMaxE</span><span class="o">&gt;</span><span class="p">,</span> <span class="mi">256</span><span class="o">&gt;</span><span class="p">,</span> <span class="mi">8</span><span class="o">&gt;</span> <span class="n">gpp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">SetMod</span><span class="p">(</span><span class="kt">int</span> <span class="n">p</span><span class="p">,</span> <span class="kt">int</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">fill</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">binomial</span><span class="o">::</span><span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="p">,</span> <span class="n">binomial</span><span class="o">::</span><span class="n">e</span> <span class="o">=</span> <span class="n">e</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">e</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">power</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">power</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">pe</span> <span class="o">=</span> <span class="n">power</span><span class="p">[</span><span class="n">e</span><span class="p">],</span> <span class="n">memo</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">kMaxE</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">binom</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">kMaxE</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">i</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">binom</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Sum</span><span class="p">(</span><span class="n">binom</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">binom</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">p</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">e</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">i128</span><span class="p">{</span><span class="n">g</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]}</span> <span class="o">*</span> <span class="n">i</span> <span class="o">%</span> <span class="n">pe</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">e</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="n">Add</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">g</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="n">gp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">kMaxE</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">i64</span><span class="o">&gt;</span> <span class="n">coef</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">i64</span> <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">i128</span><span class="p">{</span><span class="n">p</span><span class="p">}</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">%</span> <span class="n">pe</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">e</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">i64</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">e</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Add</span><span class="p">(</span><span class="n">coef</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">i128</span><span class="p">{</span><span class="n">m</span><span class="p">}</span> <span class="o">*</span> <span class="n">binom</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">%</span> <span class="n">pe</span> <span class="o">*</span> <span class="n">gp</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">%</span> <span class="n">pe</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">m</span> <span class="o">=</span> <span class="n">i128</span><span class="p">{</span><span class="n">m</span><span class="p">}</span> <span class="o">*</span> <span class="n">a</span> <span class="o">%</span> <span class="n">pe</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">e</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">gp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">j</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Add</span><span class="p">(</span><span class="n">gp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">i128</span><span class="p">{</span><span class="n">gp</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">k</span><span class="p">]}</span> <span class="o">*</span> <span class="n">coef</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="n">k</span><span class="p">]</span> <span class="o">%</span> <span class="n">pe</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">gpp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">gp</span><span class="p">[</span><span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">256</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">i64</span> <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">i128</span><span class="p">{</span><span class="n">p</span><span class="p">}</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">))</span> <span class="o">%</span> <span class="n">pe</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">pe</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">i64</span><span class="o">&gt;</span> <span class="n">coef</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">e</span><span class="p">;</span> <span class="o">++</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">i64</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">e</span><span class="p">;</span> <span class="o">++</span><span class="n">y</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="n">Add</span><span class="p">(</span><span class="n">coef</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">i128</span><span class="p">{</span><span class="n">m</span><span class="p">}</span> <span class="o">*</span> <span class="n">binom</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">%</span> <span class="n">pe</span> <span class="o">*</span> <span class="n">gpp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">%</span> <span class="n">pe</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">          <span class="n">m</span> <span class="o">=</span> <span class="n">i128</span><span class="p">{</span><span class="n">m</span><span class="p">}</span> <span class="o">*</span> <span class="n">a</span> <span class="o">%</span> <span class="n">pe</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">e</span><span class="p">;</span> <span class="o">++</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">gpp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="n">x</span><span class="p">;</span> <span class="o">++</span><span class="n">y</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="n">Add</span><span class="p">(</span><span class="n">gpp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">x</span><span class="p">],</span> <span class="n">i128</span><span class="p">{</span><span class="n">gpp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">y</span><span class="p">]}</span> <span class="o">*</span> <span class="n">coef</span><span class="p">[</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">]</span> <span class="o">%</span> <span class="n">pe</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">auto</span> <span class="nf">F</span><span class="p">(</span><span class="n">i64</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">memo</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">!=</span> <span class="n">end</span><span class="p">(</span><span class="n">memo</span><span class="p">))</span> <span class="k">return</span> <span class="n">memo</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="n">i64</span> <span class="n">ori_n</span> <span class="o">=</span> <span class="n">n</span><span class="p">,</span> <span class="n">l</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="n">n</span> <span class="o">%</span> <span class="n">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n</span> <span class="o">/=</span> <span class="n">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">n</span><span class="p">;</span> <span class="n">n</span> <span class="o">&gt;&gt;=</span> <span class="mi">8</span><span class="p">,</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">u</span> <span class="o">=</span> <span class="n">n</span> <span class="o">&amp;</span> <span class="mi">255</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">i64</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">e</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Add</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">i128</span><span class="p">{</span><span class="n">m</span><span class="p">}</span> <span class="o">*</span> <span class="n">gpp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">u</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">%</span> <span class="n">pe</span><span class="p">),</span> <span class="n">m</span> <span class="o">=</span> <span class="n">i128</span><span class="p">{</span><span class="n">m</span><span class="p">}</span> <span class="o">*</span> <span class="n">l</span> <span class="o">%</span> <span class="n">pe</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="n">l</span> <span class="o">+=</span> <span class="n">i64</span><span class="p">{</span><span class="n">p</span> <span class="o">*</span> <span class="n">u</span><span class="p">}</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">),</span> <span class="n">v</span> <span class="o">=</span> <span class="n">i128</span><span class="p">{</span><span class="n">v</span><span class="p">}</span> <span class="o">*</span> <span class="n">c</span> <span class="o">%</span> <span class="n">pe</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="n">i64</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">e</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Add</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">i128</span><span class="p">{</span><span class="n">m</span><span class="p">}</span> <span class="o">*</span> <span class="n">g</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">%</span> <span class="n">pe</span><span class="p">),</span> <span class="n">m</span> <span class="o">=</span> <span class="n">i128</span><span class="p">{</span><span class="n">m</span><span class="p">}</span> <span class="o">*</span> <span class="n">l</span> <span class="o">%</span> <span class="n">pe</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">memo</span><span class="p">[</span><span class="n">ori_n</span><span class="p">]</span> <span class="o">=</span> <span class="n">i128</span><span class="p">{</span><span class="n">v</span><span class="p">}</span> <span class="o">*</span> <span class="n">c</span> <span class="o">%</span> <span class="n">pe</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">auto</span> <span class="nf">CountFactor</span><span class="p">(</span><span class="n">i64</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">i64</span> <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(;</span> <span class="n">n</span> <span class="o">/=</span> <span class="n">p</span><span class="p">;)</span> <span class="n">cnt</span> <span class="o">+=</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">cnt</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">auto</span> <span class="nf">Reduce</span><span class="p">(</span><span class="n">i64</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">i64</span> <span class="n">mul</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(;</span> <span class="n">n</span><span class="p">;</span> <span class="n">n</span> <span class="o">/=</span> <span class="n">p</span><span class="p">)</span> <span class="n">mul</span> <span class="o">=</span> <span class="n">i128</span><span class="p">{</span><span class="n">mul</span><span class="p">}</span> <span class="o">*</span> <span class="n">F</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">%</span> <span class="n">pe</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">mul</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">auto</span> <span class="nf">Binom</span><span class="p">(</span><span class="n">i64</span> <span class="n">n</span><span class="p">,</span> <span class="n">i64</span> <span class="n">m</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">i64</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">m</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">)</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">i64</span> <span class="n">exp</span> <span class="o">=</span> <span class="n">CountFactor</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="n">CountFactor</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">-</span> <span class="n">CountFactor</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">m</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">exp</span> <span class="o">&gt;=</span> <span class="n">e</span><span class="p">)</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">i64</span> <span class="n">rn</span> <span class="o">=</span> <span class="n">Reduce</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">rm</span> <span class="o">=</span> <span class="n">Reduce</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="n">rnm</span> <span class="o">=</span> <span class="n">Reduce</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">m</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">i128</span><span class="p">{</span><span class="n">rn</span><span class="p">}</span> <span class="o">*</span> <span class="n">Inv</span><span class="p">(</span><span class="n">rm</span><span class="p">,</span> <span class="n">pe</span><span class="p">)</span> <span class="o">%</span> <span class="n">pe</span> <span class="o">*</span> <span class="n">Inv</span><span class="p">(</span><span class="n">rnm</span><span class="p">,</span> <span class="n">pe</span><span class="p">)</span> <span class="o">%</span> <span class="n">pe</span> <span class="o">*</span> <span class="n">power</span><span class="p">[</span><span class="n">exp</span><span class="p">]</span> <span class="o">%</span> <span class="n">pe</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>  <span class="c1">// namespace binomial
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="n">i64</span> <span class="n">m</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">M</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">i64</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">decom</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">Decom</span><span class="p">(</span><span class="n">i64</span> <span class="n">m</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i64</span><span class="p">{</span><span class="n">i</span><span class="p">}</span> <span class="o">*</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">decom</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">m</span> <span class="o">%</span> <span class="n">i</span><span class="p">))</span> <span class="o">++</span><span class="n">decom</span><span class="p">.</span><span class="n">back</span><span class="p">().</span><span class="n">second</span><span class="p">,</span> <span class="n">m</span> <span class="o">/=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="n">decom</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="n">i64</span><span class="p">,</span> <span class="n">i64</span><span class="o">&gt;</span> <span class="n">phi</span><span class="p">,</span> <span class="n">mu</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">Dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="n">i64</span> <span class="n">v</span><span class="p">,</span> <span class="n">i64</span> <span class="n">p</span><span class="p">,</span> <span class="n">i64</span> <span class="n">m</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">u</span> <span class="o">==</span> <span class="n">decom</span><span class="p">.</span><span class="n">size</span><span class="p">())</span> <span class="k">return</span> <span class="n">phi</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">,</span> <span class="kt">void</span><span class="p">(</span><span class="n">mu</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Dfs</span><span class="p">(</span><span class="n">u</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">m</span><span class="p">),</span> <span class="n">p</span> <span class="o">*=</span> <span class="p">(</span><span class="n">decom</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">first</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">m</span> <span class="o">=</span> <span class="o">-</span><span class="n">m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">decom</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">second</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">v</span> <span class="o">*=</span> <span class="n">decom</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">first</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Dfs</span><span class="p">(</span><span class="n">u</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">m</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span> <span class="o">*=</span> <span class="n">decom</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">first</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">auto</span> <span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">int</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">std</span><span class="o">::</span><span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">std</span><span class="o">::</span><span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="k">nullptr</span><span class="p">),</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="k">nullptr</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">std</span><span class="o">::</span><span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">m</span> <span class="o">&gt;&gt;</span> <span class="n">r</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">k</span> <span class="o">&gt;&gt;</span> <span class="n">M</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">i64</span> <span class="n">ep</span> <span class="o">=</span> <span class="p">((</span><span class="n">i128</span><span class="p">{</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">}</span> <span class="o">*</span> <span class="n">k</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">r</span><span class="p">)</span> <span class="o">%</span> <span class="n">m</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span> <span class="o">%</span> <span class="n">m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">Decom</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="n">Dfs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">i64</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">p</span> <span class="o">&lt;=</span> <span class="mf">1E5</span><span class="p">;</span> <span class="o">++</span><span class="n">p</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">M</span> <span class="o">%</span> <span class="n">p</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">M</span> <span class="o">%</span> <span class="n">p</span><span class="p">))</span> <span class="o">++</span><span class="n">e</span><span class="p">,</span> <span class="n">M</span> <span class="o">/=</span> <span class="n">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">binomial</span><span class="o">::</span><span class="n">SetMod</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">i64</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="p">[</span><span class="n">d</span><span class="p">,</span> <span class="n">phi</span><span class="p">]</span> <span class="o">:</span> <span class="o">::</span><span class="n">phi</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="n">d</span> <span class="o">-</span> <span class="n">k</span> <span class="o">%</span> <span class="n">d</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">i64</span> <span class="n">g</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">__gcd</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">ep</span><span class="p">),</span> <span class="n">mul</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">mul</span> <span class="o">=</span> <span class="p">(</span><span class="n">phi</span> <span class="o">/</span> <span class="o">::</span><span class="n">phi</span><span class="p">[</span><span class="n">d</span> <span class="o">/</span> <span class="n">g</span><span class="p">])</span> <span class="o">*</span> <span class="n">mu</span><span class="p">[</span><span class="n">d</span> <span class="o">/</span> <span class="n">g</span><span class="p">]</span> <span class="o">%</span> <span class="n">binomial</span><span class="o">::</span><span class="n">pe</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">mul</span> <span class="o">=</span> <span class="n">i128</span><span class="p">{</span><span class="n">mul</span><span class="p">}</span> <span class="o">*</span> <span class="n">binomial</span><span class="o">::</span><span class="n">Binom</span><span class="p">(</span><span class="n">n</span> <span class="o">/</span> <span class="n">d</span><span class="p">,</span> <span class="n">k</span> <span class="o">/</span> <span class="n">d</span><span class="p">)</span> <span class="o">%</span> <span class="n">binomial</span><span class="o">::</span><span class="n">pe</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="n">ans</span> <span class="o">+=</span> <span class="n">mul</span><span class="p">)</span> <span class="o">%=</span> <span class="n">binomial</span><span class="o">::</span><span class="n">pe</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">i128</span> <span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Exgcd</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">binomial</span><span class="o">::</span><span class="n">pe</span><span class="p">,</span> <span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">i128</span><span class="p">{</span><span class="n">ans</span> <span class="o">-</span> <span class="n">a</span><span class="p">}</span> <span class="o">*</span> <span class="p">(</span><span class="n">k1</span> <span class="o">%</span> <span class="n">binomial</span><span class="o">::</span><span class="n">pe</span><span class="p">)</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">binomial</span><span class="o">::</span><span class="n">pe</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">b</span> <span class="o">*=</span> <span class="n">binomial</span><span class="o">::</span><span class="n">pe</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">a</span> <span class="o">+=</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div>
      
    
  



        </article>
        <div class='nextprev'>
  
    
      
      

      
      
      
        
          
        
      
        
      
        
      

      
        <div class='left'>
        
          <a href='https://faqak.github.io/misc/' id='prev-article'>← ../Misc</a>
        
        </div>
        <div class='right'>
        
          <a href='https://faqak.github.io/misc/circ-cover/' id='next-article'>一类三分套三分在圆覆盖问题中的应用 →</a>
        
        </div>
      
    
  
</div>

      </main>
      <footer>
  Copyright 2021–2022 Sergey Slotin
  <br>
   
</footer>

    </div>
  </body>
</html>
